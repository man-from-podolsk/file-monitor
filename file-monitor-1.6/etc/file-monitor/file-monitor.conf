# =============================================================================
# Файл конфигурации для file-monitor.sh
# =============================================================================
# Этот файл управляется пользователем. При обновлении пакета он НЕ будет перезаписан.
# Все пути и параметры можно менять без редактирования самого скрипта.
# =============================================================================

# --- Основные директории ------------------------------------------------------

# Каталог для хранения кэшированных копий отслеживаемых файлов.
# Важно: должно быть на той же файловой системе, что и мониторинговые файлы,
# если используется сохранение метаданных через cp -p.
cache_dir=/var/cache/file-monitor

# Файл, в который записываются события (изменения содержимого, прав, владельца и диффы).
# Должен быть доступен на запись для root.
log_file=/var/log/file-monitor/file-monitor.log


# --- Поведение мониторинга ----------------------------------------------------

# Интервал проверки новых событий auditd (в секундах).
# Рекомендуется: 30–300. Меньше — чаще проверки, выше — меньше нагрузка.
interval=60

# Ключ (key), который используется в правилах auditd.
# Не меняйте, если не уверены — должен совпадать с тем, что использует скрипт.
audit_key=file-monitor

# Включить логирование текстовых различий (diff) при изменении файлов?
#   true  — показывать, какие строки добавлены/удалены.
#   false — только факт изменения.
enable_diff=true

# Максимальный размер файла (в килобайтах), для которого будет строиться diff.
# Файлы больше этого размера будут логироваться без содержимого изменений.
# Значение 0 — отключает ограничение (не рекомендуется для больших файлов).
max_file_size_kb=1024


# --- Список отслеживаемых путей -----------------------------------------------

# Каждый путь указывается в отдельной строке с префиксом "path=".
# Поддерживаются:
#   - Абсолютные пути: /etc/fstab
#   - Директории (рекурсивный обход всех файлов внутри): /etc/sudoers.d/
#   - Wildcard-шаблоны: /nfs/shared/*/custom/config/global.ini
#
# Примечания:
#   - Временные файлы (.swp, ~, .tmp, .bak, .rpmnew и т.д.) автоматически игнорируются.
#   - Не существующие пути пропускаются без ошибки.
#   - Для мониторинга целых каталогов указывайте путь с завершающим слэшем.

path=/etc/fstab
#path=/etc/hosts
#path=/etc/ssh/sshd_config
#path=/etc/sudoers
#path=/etc/sudoers.d/
#path=/etc/security/limits.conf
#path=/etc/nsswitch.conf
#path=/etc/exports
#path=/boot/grub2/grub.cfg

# Примеры неактивных (закомментированных) путей:
# path=/etc/sysctl.conf
# path=/nfs/shared/*/custom/config/global.ini

# =============================================================================
# Конец файла конфигурации
# =============================================================================
