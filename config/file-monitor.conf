# =============================================================================
# Configuration file for file-monitor.service
# =============================================================================
# This file is managed by the user. It will NOT be overwritten during package upgrades.
# You can modify all paths and parameters without editing the script itself.
# =============================================================================

# --- Core directories ---------------------------------------------------------

# Directory for storing cached copies of monitored files.
# Important: This should reside on the same filesystem as the monitored files
# if metadata preservation (via `cp -p`) is used.
cache_dir = /var/cache/file-monitor

# Log file where events (content changes, permission/ownership changes, diffs) are recorded.
# Must be writable by root.
log_file = /var/log/file-monitor/file-monitor.log

# --- Monitoring behavior ------------------------------------------------------

# Interval (in seconds) between checks for new auditd events.
# Recommended range: 30–300. Lower values mean more frequent checks; higher values reduce load.
interval = 10

# Audit key used in auditd rules.
# Do not change unless you know what you're doing — must match the key used by the script.
audit_key = file-monitor

# Enable logging of textual differences (diff) when files change?
#   true  — shows which lines were added/removed.
#   false — logs only the fact of modification.
enable_diff = true

# Maximum file size (in kilobytes) for which a diff will be generated.
# Files larger than this will be logged without content differences.
# Set to 0 to disable size limits (not recommended for large files).
max_file_size_kb = 1024

# --- List of paths to monitor -------------------------------------------------

# Specify each path on a separate line using the "path=" prefix.
# Supported formats:
#   - Absolute paths: /etc/fstab
#   - Directories (recursive scan of all files inside): /etc/sudoers.d/
#   - Wildcard patterns: /nfs/shared/*/custom/config/global.ini
#
# Notes:
#   - Temporary files (.swp, ~, .tmp, .bak, .rpmnew, etc.) are automatically ignored.
#   - Non-existent paths are silently skipped.
#   - For directory monitoring, include a trailing slash.

path = /etc/fstab
path = /etc/sudoers.d/

# Example paths:
#path = /etc/hosts
#path = /etc/ssh/sshd_config
#path = /etc/sudoers
#path = /etc/security/limits.conf
#path = /etc/nsswitch.conf
#path = /etc/exports
#path = /boot/grub2/grub.cfg
#path = /etc/sysctl.conf
#path = /nfs/shared/*/custom/config/global.ini

# =============================================================================
# End of configuration file
# =============================================================================
